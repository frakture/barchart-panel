{"version":3,"sources":["../src/legend.js"],"names":[],"mappings":";;;;;;;;;AAAO,a;;AACA,O;;AACA,O;;;;AAIP,cAAQ,MAAR,CAAe,oBAAf,EAAqC,SAArC,CAA+C,gBAA/C,EAAiE,YAAW;AAC1E,eAAO;AACL,gBAAM,cAAS,KAAT,EAAgB,IAAhB,EAAsB;AAC1B,gBAAI,aAAa,EAAE,0CAAF,CAAjB;AACA,gBAAI,cAAc,IAAlB;AACA,gBAAI,OAAO,MAAM,IAAjB;AACA,gBAAI,QAAQ,KAAK,KAAjB;AACA,gBAAI,IAAJ;AACA,gBAAI,UAAJ;AACA,gBAAI,CAAJ;;AAEA,iBAAK,MAAL,CAAY,EAAZ,CAAe,QAAf,EAAyB,YAAW;AAClC,qBAAO,KAAK,MAAZ;AACA,kBAAI,IAAJ,EAAU;AACR,qBAAI,IAAI,CAAR,IAAa,IAAb,EAAmB;AACjB,uBAAK,CAAL,EAAQ,KAAR,GAAgB,KAAK,IAAL,CAAU,CAAV,EAAa,KAA7B;AACD;AACD;AACD;AACF,aARD;;AAUA,qBAAS,MAAT,GAAkB;AAChB,kBAAI,WAAJ,EAAiB;AACf,qBAAK,MAAL,CAAY,UAAZ;AACA,8BAAc,KAAd;AACD;;AAED,2BAAa,IAAb;;AAEA,yBAAW,KAAX;;AAEA,kBAAI,cAAc,MAAM,WAAN,IAAqB,MAAM,MAAN,CAAa,MAApD;;AAEA,yBAAW,WAAX,CAAuB,oBAAvB,EAA6C,WAA7C;;AAEA,kBAAI,WAAJ,EAAiB;AACf,oBAAI,SAAS,mDAAb;AACA,oBAAI,MAAM,MAAN,CAAa,MAAjB,EAAyB;AACvB,4BAAU,2BAAV;AACD;AACD,0BAAU,OAAV;AACA,2BAAW,MAAX,CAAkB,EAAE,MAAF,CAAlB;AACD;;AAED,mBAAK,IAAI,CAAT,EAAY,IAAI,WAAW,MAA3B,EAAmC,GAAnC,EAAwC;AACtC,oBAAI,SAAS,WAAW,CAAX,CAAb;;AAEA;AACA,oBAAI,MAAM,MAAN,CAAa,SAAb,IAA0B,OAAO,SAArC,EAAgD;AAC9C;AACD;AACD;AACA,oBAAI,CAAC,OAAO,MAAZ,EAAoB;AAClB;AACD;;AAED,oBAAI,OAAO,iCAAX;AACA,wBAAQ,0BAA0B,CAA1B,GAA8B,IAAtC;AACA,wBAAQ,6CAAR;AACA,wBAAQ,yCAAyC,OAAO,KAAhD,GAAwD,QAAhE;AACA,wBAAQ,SAAR;;AAEA,wBAAQ,8CAAR;AACA,wBAAQ,2BAA2B,OAAO,KAAlC,GAA0C,MAAlD;AACA,wBAAQ,SAAR;;AAEA,oBAAI,MAAM,MAAN,CAAa,MAAjB,EAAyB;AACvB,0BAAQ,+CAA6C,KAAK,KAAL,CAAW,SAAxD,GAAkE,IAAlE,GAAyE,KAAK,WAAL,CAAiB,OAAO,KAAP,CAAa,KAAK,KAAL,CAAW,SAAxB,CAAjB,CAAzE,GAAgI,QAAxI;AACD;;AAED,wBAAQ,QAAR;AACA,2BAAW,MAAX,CAAkB,EAAE,IAAF,CAAlB;AACD;AACF;AACF;AAzEI,SAAP;AA2ED,OA5ED","file":"legend.js","sourcesContent":["import angular from 'angular';\r\nimport _ from  'lodash';\r\nimport $ from  'jquery';\r\nimport 'jquery.flot';\r\nimport 'jquery.flot.time';\r\n\r\nangular.module('grafana.directives').directive('barchartLegend', function() {\r\n  return {\r\n    link: function(scope, elem) {\r\n      var $container = $('<section class=\"graph-legend\"></section>');\r\n      var firstRender = true;\r\n      var ctrl = scope.ctrl;\r\n      var panel = ctrl.panel;\r\n      var data;\r\n      var seriesList;\r\n      var i;\r\n\r\n      ctrl.events.on('render', function() {\r\n        data = ctrl.series;\r\n        if (data) {\r\n          for(var i in data) {\r\n            data[i].color = ctrl.data[i].color;\r\n          }\r\n          render();\r\n        }\r\n      });\r\n\r\n      function render() {\r\n        if (firstRender) {\r\n          elem.append($container);\r\n          firstRender = false;\r\n        }\r\n\r\n        seriesList = data;\r\n\r\n        $container.empty();\r\n\r\n        var tableLayout = panel.legendTable && panel.legend.values;\r\n\r\n        $container.toggleClass('graph-legend-table', tableLayout);\r\n\r\n        if (tableLayout) {\r\n          var header = '<tr><th colspan=\"2\" style=\"text-align:left\"></th>';\r\n          if (panel.legend.values) {\r\n            header += '<th class=\"pointer\"></th>';\r\n          }\r\n          header += '</tr>';\r\n          $container.append($(header));\r\n        }\r\n\r\n        for (i = 0; i < seriesList.length; i++) {\r\n          var series = seriesList[i];\r\n\r\n          // ignore empty series\r\n          if (panel.legend.hideEmpty && series.allIsNull) {\r\n            continue;\r\n          }\r\n          // ignore series excluded via override\r\n          if (!series.legend) {\r\n            continue;\r\n          }\r\n\r\n          var html = '<div class=\"graph-legend-series';\r\n          html += '\" data-series-index=\"' + i + '\">';\r\n          html += '<span class=\"graph-legend-icon no-pointer\">';\r\n          html += '<i class=\"fa fa-minus\" style=\"color:' + series.color + '\"></i>';\r\n          html += '</span>';\r\n\r\n          html += '<span class=\"graph-legend-alias no-pointer\">';\r\n          html += '<a class=\"no-pointer\">' + series.label + '</a>';\r\n          html += '</span>';\r\n\r\n          if (panel.legend.values) {\r\n            html += '<div class=\"graph-legend-value no-pointer '+ctrl.panel.valueName+'\">' + ctrl.formatValue(series.stats[ctrl.panel.valueName]) + '</div>';\r\n          }\r\n\r\n          html += '</div>';\r\n          $container.append($(html));\r\n        }\r\n      }\r\n    }\r\n  };\r\n});\r\n\r\n\r\n"]}